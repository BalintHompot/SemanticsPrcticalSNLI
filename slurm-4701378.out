Accessing raw input and preprocessing
done
Building vocabulary with GloVe
2020-04-14 13:15:04,756 : Loading vectors from .vector_cache/glove.840B.300d.txt.pt
done
Loading data into iterables
done, returning data
Data loaded, starting train
--------- Fitting models and testing on set-aside data ------------
Vector mean SNLI optimized parameters already exists, retrieving
best learning rate retrieved from stored param file
best lr stopping criterion retrived from stored param file
best lr decrease factor retrived from stored param file
-----------------
best model already stored and force retrain is false
retrieving model
-----------------
+++++++++++++++++++++++++++++++++++++++++++++
Final performance of Vector mean SNLI with optimal params on test partition.
/home/lgpu0015/.local/lib/python3.6/site-packages/torch/nn/modules/container.py:100: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  input = module(input)
test accuracy: 0.740467171717
2020-04-14 13:15:34,663 : ***** Transfer task : MR *****


2020-04-14 13:15:34,904 : Generating sentence embeddings
2020-04-14 13:15:35,710 : Generated sentence embeddings
2020-04-14 13:15:35,711 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 10-fold cross-validation
2020-04-14 13:22:29,564 : Best param found at split 1: l2reg = 1e-05                 with score 75.5
2020-04-14 13:29:01,304 : Best param found at split 2: l2reg = 1e-05                 with score 75.43
2020-04-14 13:35:49,004 : Best param found at split 3: l2reg = 1e-05                 with score 75.08
2020-04-14 13:42:31,273 : Best param found at split 4: l2reg = 1e-05                 with score 75.31
2020-04-14 13:49:22,156 : Best param found at split 5: l2reg = 0.0001                 with score 75.28
2020-04-14 13:56:11,854 : Best param found at split 6: l2reg = 1e-05                 with score 74.99
2020-04-14 14:02:40,800 : Best param found at split 7: l2reg = 1e-05                 with score 74.95
2020-04-14 14:09:23,407 : Best param found at split 8: l2reg = 1e-05                 with score 75.11
2020-04-14 14:14:41,114 : Best param found at split 9: l2reg = 1e-05                 with score 75.3
2020-04-14 14:20:08,169 : Best param found at split 10: l2reg = 1e-05                 with score 75.01
2020-04-14 14:20:19,305 : Dev acc : 75.2 Test acc : 74.33

2020-04-14 14:20:19,310 : ***** Transfer task : CR *****


2020-04-14 14:20:19,458 : Generating sentence embeddings
2020-04-14 14:20:19,723 : Generated sentence embeddings
2020-04-14 14:20:19,724 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 10-fold cross-validation
2020-04-14 14:22:25,864 : Best param found at split 1: l2reg = 0.0001                 with score 78.89
2020-04-14 14:24:34,945 : Best param found at split 2: l2reg = 1e-05                 with score 79.25
2020-04-14 14:26:42,711 : Best param found at split 3: l2reg = 0.0001                 with score 78.86
2020-04-14 14:28:54,150 : Best param found at split 4: l2reg = 1e-05                 with score 79.04
2020-04-14 14:31:07,339 : Best param found at split 5: l2reg = 0.0001                 with score 79.42
2020-04-14 14:33:10,895 : Best param found at split 6: l2reg = 1e-05                 with score 78.96
2020-04-14 14:35:27,540 : Best param found at split 7: l2reg = 1e-05                 with score 78.99
2020-04-14 14:38:12,038 : Best param found at split 8: l2reg = 0.0001                 with score 78.93
2020-04-14 14:40:47,795 : Best param found at split 9: l2reg = 0.001                 with score 78.31
2020-04-14 14:43:30,987 : Best param found at split 10: l2reg = 0.0001                 with score 79.52
2020-04-14 14:43:35,576 : Dev acc : 79.02 Test acc : 78.01

2020-04-14 14:43:35,576 : ***** Transfer task : SUBJ *****


2020-04-14 14:43:37,237 : Generating sentence embeddings
2020-04-14 14:43:37,976 : Generated sentence embeddings
2020-04-14 14:43:37,977 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 10-fold cross-validation
2020-04-14 14:50:24,408 : Best param found at split 1: l2reg = 1e-05                 with score 90.09
2020-04-14 14:57:07,095 : Best param found at split 2: l2reg = 0.0001                 with score 90.27
2020-04-14 15:03:58,693 : Best param found at split 3: l2reg = 1e-05                 with score 90.37
2020-04-14 15:10:44,294 : Best param found at split 4: l2reg = 1e-05                 with score 90.28
2020-04-14 15:17:27,090 : Best param found at split 5: l2reg = 1e-05                 with score 90.37
2020-04-14 15:23:58,085 : Best param found at split 6: l2reg = 0.0001                 with score 90.51
2020-04-14 15:29:18,047 : Best param found at split 7: l2reg = 1e-05                 with score 90.33
2020-04-14 15:34:29,923 : Best param found at split 8: l2reg = 1e-05                 with score 90.09
2020-04-14 15:39:44,287 : Best param found at split 9: l2reg = 1e-05                 with score 90.21
2020-04-14 15:45:04,276 : Best param found at split 10: l2reg = 1e-05                 with score 90.22
2020-04-14 15:45:12,826 : Dev acc : 90.27 Test acc : 89.53

2020-04-14 15:45:12,828 : ***** Transfer task : MPQA *****


2020-04-14 15:45:12,954 : Generating sentence embeddings
2020-04-14 15:45:13,522 : Generated sentence embeddings
2020-04-14 15:45:13,523 : Training pytorch-MLP-nhid0-adam-bs64 with (inner) 10-fold cross-validation
2020-04-14 15:49:41,936 : Best param found at split 1: l2reg = 1e-05                 with score 85.48
2020-04-14 15:54:02,596 : Best param found at split 2: l2reg = 1e-05                 with score 85.0
2020-04-14 15:58:19,473 : Best param found at split 3: l2reg = 1e-05                 with score 84.7
2020-04-14 16:02:35,737 : Best param found at split 4: l2reg = 1e-05                 with score 84.77
2020-04-14 16:07:09,244 : Best param found at split 5: l2reg = 0.0001                 with score 85.22
2020-04-14 16:11:27,368 : Best param found at split 6: l2reg = 0.0001                 with score 85.04
2020-04-14 16:16:00,572 : Best param found at split 7: l2reg = 1e-05                 with score 85.06
2020-04-14 16:20:26,812 : Best param found at split 8: l2reg = 1e-05                 with score 85.02
2020-04-14 16:24:41,675 : Best param found at split 9: l2reg = 1e-05                 with score 85.1
2020-04-14 16:29:19,083 : Best param found at split 10: l2reg = 0.0001                 with score 85.24
2020-04-14 16:29:25,325 : Dev acc : 85.06 Test acc : 84.6

2020-04-14 16:29:25,330 : 

***** Transfer task : STSBenchmark*****


2020-04-14 16:29:25,574 : Computing embedding for train
2020-04-14 16:29:26,315 : Computed train embeddings
2020-04-14 16:29:26,315 : Computing embedding for dev
2020-04-14 16:29:26,516 : Computed dev embeddings
2020-04-14 16:29:26,516 : Computing embedding for test
2020-04-14 16:29:26,693 : Computed test embeddings
2020-04-14 16:30:01,139 : Dev : Pearson 0.7062244100916107
2020-04-14 16:30:01,139 : Test : Pearson 0.6255316012485217 Spearman 0.6019311044094815 MSE 1.6589096334974893                        for SICK Relatedness

2020-04-14 16:30:01,139 : ***** Transfer task : SST Binary classification *****


2020-04-14 16:30:01,641 : Computing embedding for train
2020-04-14 16:30:05,834 : Computed train embeddings
2020-04-14 16:30:05,834 : Computing embedding for dev
2020-04-14 16:30:05,908 : Computed dev embeddings
2020-04-14 16:30:05,908 : Computing embedding for test
2020-04-14 16:30:06,038 : Computed test embeddings
2020-04-14 16:30:06,038 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2020-04-14 16:33:35,083 : [('reg:1e-05', 78.44), ('reg:0.0001', 77.98), ('reg:0.001', 77.29), ('reg:0.01', 75.92)]
2020-04-14 16:33:35,083 : Validation : best param found is reg = 1e-05 with score             78.44
2020-04-14 16:33:35,083 : Evaluating...
2020-04-14 16:34:36,405 : 
Dev acc : 78.44 Test acc : 79.24 for             SST Binary classification

2020-04-14 16:34:36,410 : ***** Transfer task : SST Fine-Grained classification *****


2020-04-14 16:34:36,601 : Computing embedding for train
2020-04-14 16:34:37,214 : Computed train embeddings
2020-04-14 16:34:37,215 : Computing embedding for dev
2020-04-14 16:34:37,297 : Computed dev embeddings
2020-04-14 16:34:37,297 : Computing embedding for test
2020-04-14 16:34:37,457 : Computed test embeddings
2020-04-14 16:34:37,457 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2020-04-14 16:35:08,974 : [('reg:1e-05', 41.87), ('reg:0.0001', 42.05), ('reg:0.001', 41.6), ('reg:0.01', 38.96)]
2020-04-14 16:35:08,975 : Validation : best param found is reg = 0.0001 with score             42.05
2020-04-14 16:35:08,975 : Evaluating...
2020-04-14 16:35:14,847 : 
Dev acc : 42.05 Test acc : 42.35 for             SST Fine-Grained classification

2020-04-14 16:35:14,849 : ***** Transfer task : TREC *****


2020-04-14 16:35:15,322 : Computed train embeddings
2020-04-14 16:35:15,352 : Computed test embeddings
2020-04-14 16:35:15,353 : Training pytorch-MLP-nhid0-adam-bs64 with 10-fold cross-validation
2020-04-14 16:39:17,826 : [('reg:1e-05', 73.590000000000003), ('reg:0.0001', 73.5), ('reg:0.001', 72.599999999999994), ('reg:0.01', 65.079999999999998)]
2020-04-14 16:39:17,826 : Cross-validation : best param found is reg = 1e-05             with score 73.59
2020-04-14 16:39:17,826 : Evaluating...
2020-04-14 16:39:24,186 : 
Dev acc : 73.59 Test acc : 80.8             for TREC

2020-04-14 16:39:24,186 : ***** Transfer task : MRPC *****


2020-04-14 16:39:24,321 : Computing embedding for train
2020-04-14 16:39:24,936 : Computed train embeddings
2020-04-14 16:39:24,937 : Computing embedding for test
2020-04-14 16:39:25,194 : Computed test embeddings
2020-04-14 16:39:25,207 : Training pytorch-MLP-nhid0-adam-bs64 with 10-fold cross-validation
2020-04-14 16:41:03,501 : [('reg:1e-05', 72.030000000000001), ('reg:0.0001', 72.079999999999998), ('reg:0.001', 71.390000000000001), ('reg:0.01', 71.390000000000001)]
2020-04-14 16:41:03,501 : Cross-validation : best param found is reg = 0.0001             with score 72.08
2020-04-14 16:41:03,501 : Evaluating...
2020-04-14 16:41:05,943 : Dev acc : 72.08 Test acc 71.83; Test F1 81.31 for MRPC.

2020-04-14 16:41:05,944 : ***** Transfer task : SICK-Relatedness*****


2020-04-14 16:41:06,187 : Computing embedding for train
2020-04-14 16:41:06,741 : Computed train embeddings
2020-04-14 16:41:06,741 : Computing embedding for dev
2020-04-14 16:41:06,806 : Computed dev embeddings
2020-04-14 16:41:06,806 : Computing embedding for test
2020-04-14 16:41:07,407 : Computed test embeddings
2020-04-14 16:41:48,168 : Dev : Pearson 0.7916522434606196
2020-04-14 16:41:48,168 : Test : Pearson 0.7998494514126332 Spearman 0.7195156500523971 MSE 0.36672236750393095                        for SICK Relatedness

2020-04-14 16:41:48,173 : ***** Transfer task : SICK-Entailment*****


2020-04-14 16:41:48,247 : Computing embedding for train
2020-04-14 16:41:48,802 : Computed train embeddings
2020-04-14 16:41:48,802 : Computing embedding for dev
2020-04-14 16:41:48,866 : Computed dev embeddings
2020-04-14 16:41:48,866 : Computing embedding for test
2020-04-14 16:41:49,470 : Computed test embeddings
2020-04-14 16:41:49,509 : Training pytorch-MLP-nhid0-adam-bs64 with standard validation..
2020-04-14 16:42:10,935 : [('reg:1e-05', 79.4), ('reg:0.0001', 79.0), ('reg:0.001', 78.6), ('reg:0.01', 71.0)]
2020-04-14 16:42:10,936 : Validation : best param found is reg = 1e-05 with score             79.4
2020-04-14 16:42:10,936 : Evaluating...
2020-04-14 16:42:16,254 : 
Dev acc : 79.4 Test acc : 77.43 for                        SICK entailment

2020-04-14 16:42:16,259 : ***** Transfer task : STS14 *****


2020-04-14 16:42:16,524 : deft-forum : pearson = 0.2635, spearman = 0.3163
2020-04-14 16:42:16,608 : deft-news : pearson = 0.5880, spearman = 0.5979
/home/lgpu0015/.local/lib/python3.6/site-packages/SentEval-0.1.0-py3.6.egg/senteval/utils.py:39: RuntimeWarning: invalid value encountered in float_scalars
2020-04-14 16:42:16,800 : headlines : pearson = 0.5131, spearman = 0.5151
2020-04-14 16:42:16,992 : images : pearson = 0.6357, spearman = 0.6178
2020-04-14 16:42:17,183 : OnWN : pearson = 0.5153, spearman = 0.5860
2020-04-14 16:42:17,380 : tweet-news : pearson = 0.4896, spearman = 0.5048
2020-04-14 16:42:17,381 : ALL (weighted average) : Pearson = 0.5094,             Spearman = 0.5305
2020-04-14 16:42:17,381 : ALL (average) : Pearson = 0.5009,             Spearman = 0.5230

Traceback (most recent call last):
  File "trainMain.py", line 54, in <module>
    runSentEval(best_model, TEXT, tasks="paper")
  File "/home/lgpu0015/SemanticsPrcticalSNLI/sentEval.py", line 73, in runSentEval
    json.dump(results, writer, indent=1)
  File "/hpc/eb/Debian9/Python/3.6.3-foss-2017b/lib/python3.6/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/hpc/eb/Debian9/Python/3.6.3-foss-2017b/lib/python3.6/json/encoder.py", line 430, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/hpc/eb/Debian9/Python/3.6.3-foss-2017b/lib/python3.6/json/encoder.py", line 404, in _iterencode_dict
    yield from chunks
  File "/hpc/eb/Debian9/Python/3.6.3-foss-2017b/lib/python3.6/json/encoder.py", line 404, in _iterencode_dict
    yield from chunks
  File "/hpc/eb/Debian9/Python/3.6.3-foss-2017b/lib/python3.6/json/encoder.py", line 437, in _iterencode
    o = _default(o)
  File "/hpc/eb/Debian9/Python/3.6.3-foss-2017b/lib/python3.6/json/encoder.py", line 180, in default
    o.__class__.__name__)
TypeError: Object of type 'ndarray' is not JSON serializable
srun: error: r31n5: task 0: Exited with exit code 1
